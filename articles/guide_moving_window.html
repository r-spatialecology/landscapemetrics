<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Moving window • landscapemetrics</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Moving window">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">landscapemetrics</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.2</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/get_started.html"><span class="fa fa-magic"></span> Get Started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html"><span class="fa fa-gears"></span> Functions</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-more" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true"><span class="fa fa-graduation-cap"></span> More</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-more">
<li><a class="dropdown-item" href="../articles/general_background.html"><span class="fa fa-book"></span> General Background</a></li>
    <li><a class="dropdown-item" href="../articles/comparing_tools.html"><span class="fa fa-book"></span> Differences FRAGSTATS|landscapemetrics</a></li>
    <li><a class="dropdown-item" href="../articles/landscape_distribution_statistics.html"><span class="fa fa-book"></span> Landscape distribution statistics</a></li>
    <li><a class="dropdown-item" href="../articles/new_metrics.html"><span class="fa fa-book"></span> New Metrics outside FRAGSTATS</a></li>
    <li><a class="dropdown-item" href="../articles/guide_sample_lsm.html"><span class="fa fa-book"></span> Sample metrics</a></li>
    <li><a class="dropdown-item" href="../articles/guide_moving_window.html"><span class="fa fa-book"></span> Moving window</a></li>
    <li><a class="dropdown-item" href="../articles/irregular_areas.html"><span class="fa fa-book"></span> Calculating landscape metrics for irregular areas</a></li>
    <li><a class="dropdown-item" href="../articles/utility.html"><span class="fa fa-book"></span> Utility functions</a></li>
    <li><a class="dropdown-item" href="../articles/publication_record.html"><span class="fa fa-file-text-o"></span> Publication Record</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html"><span class="fa fa-newspaper-o"></span> News</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/r-spatialecology/landscapemetrics/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://www.maxhesselbarth.com/"><span class="fa fa-user"></span></a></li>
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Moving window</h1>
            
            <h4 data-toc-skip class="date">2025-01-10</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/r-spatialecology/landscapemetrics/blob/v2.2/vignettes/articles/guide_moving_window.Rmd" class="external-link"><code>vignettes/articles/guide_moving_window.Rmd</code></a></small>
      <div class="d-none name"><code>guide_moving_window.Rmd</code></div>
    </div>

    
    
<p>Results of a landscape analysis are scale dependent (Šímová 2012).
One approach to deal with this is by using a moving window (Hagen-Zanker
2016). For each focal cell in the landscape, a matrix is used to specify
the neighborhood and the metric value of this local neighborhood is
assigned to each focal cell (Fletcher 2018). Thereby, the windows are
allowed to overlap (McGarigal et al. 2012). The result of a moving
window analysis is a raster with an identical extent as the input,
however, each cell now describes the neighborhood in regard to the
variability of the chosen metric (Hagen-Zanker 2016). Of course, the
selection of the matrix size largely influences the scale of the result
(Hagen-Zanker 2016).</p>
<div class="section level2">
<h2 id="implementation-in-landscapemetrics">Implementation in <strong>landscapemetrics</strong><a class="anchor" aria-label="anchor" href="#implementation-in-landscapemetrics"></a>
</h2>
<p>We provide the function <code><a href="../reference/window_lsm.html">window_lsm()</a></code> in
<strong>landscapemetrics</strong> to analyse an input raster using the
moving window approach. The function allows to specify the neighborhood
using a matrix using the <code><a href="https://rspatial.github.io/terra/reference/focal.html" class="external-link">terra::focal()</a></code> function
internally. Currently, only the landscape level metrics are possible to
calculate and they can be specified similarly to
<code><a href="../reference/calculate_lsm.html">calculate_lsm()</a></code>. For details, see
<code>?list_lsm()</code>.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-spatialecology.github.io/landscapemetrics/">landscapemetrics</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://rspatial.org/" class="external-link">terra</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># internal data needs to be read</span></span>
<span><span class="va">landscape</span> <span class="op">&lt;-</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/rast.html" class="external-link">rast</a></span><span class="op">(</span><span class="fu">landscapemetrics</span><span class="fu">::</span><span class="va"><a href="../reference/landscape.html">landscape</a></span><span class="op">)</span></span></code></pre></div>
<p>First, we need to specify the local neighborhood matrix. This matrix
must have sides defined as odd numbers, in which the focal cell is
always the center cell (for more details, see
<code>?terra::focal()</code>).</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">moving_window</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">1</span>, nrow <span class="op">=</span> <span class="fl">3</span>, ncol <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span><span class="va">moving_window</span></span></code></pre></div>
<pre><code><span><span class="co">##      [,1] [,2] [,3]</span></span>
<span><span class="co">## [1,]    1    1    1</span></span>
<span><span class="co">## [2,]    1    1    1</span></span>
<span><span class="co">## [3,]    1    1    1</span></span></code></pre>
<p>Now, we can easily pass this matrix to <code><a href="../reference/window_lsm.html">window_lsm()</a></code>
together with the input landscape. For this example, we want to
calculate the number of classes (<code>lsm_l_pr</code>) and the joint
entropy (<code>lsm_l_joinent</code>) for the local neighborhoods.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">result</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/window_lsm.html">window_lsm</a></span><span class="op">(</span><span class="va">landscape</span>, window <span class="op">=</span> <span class="va">moving_window</span>, what <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"lsm_l_pr"</span>, <span class="st">"lsm_l_joinent"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">result</span></span></code></pre></div>
<pre><code><span><span class="co">## $layer_1</span></span>
<span><span class="co">## $layer_1$lsm_l_joinent</span></span>
<span><span class="co">## class       : SpatRaster </span></span>
<span><span class="co">## dimensions  : 30, 30, 1  (nrow, ncol, nlyr)</span></span>
<span><span class="co">## resolution  : 1, 1  (x, y)</span></span>
<span><span class="co">## extent      : 0, 30, 0, 30  (xmin, xmax, ymin, ymax)</span></span>
<span><span class="co">## coord. ref. :  </span></span>
<span><span class="co">## source(s)   : memory</span></span>
<span><span class="co">## name        :   clumps </span></span>
<span><span class="co">## min value   : 0.000000 </span></span>
<span><span class="co">## max value   : 3.093069 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $layer_1$lsm_l_pr</span></span>
<span><span class="co">## class       : SpatRaster </span></span>
<span><span class="co">## dimensions  : 30, 30, 1  (nrow, ncol, nlyr)</span></span>
<span><span class="co">## resolution  : 1, 1  (x, y)</span></span>
<span><span class="co">## extent      : 0, 30, 0, 30  (xmin, xmax, ymin, ymax)</span></span>
<span><span class="co">## coord. ref. :  </span></span>
<span><span class="co">## source(s)   : memory</span></span>
<span><span class="co">## name        : clumps </span></span>
<span><span class="co">## min value   :      1 </span></span>
<span><span class="co">## max value   :      3</span></span></code></pre>
<p>To be type-stable, the result will be a nested list. The first level
includes all layers of a <code>SpatRaster</code> (only one if a
<code>SpatRaster</code> is provided), the second level contains all
selected metrics. The resulting <code>SpatRaster</code> describe the
local neighborhood according to the moving window around each focal
cell. In the case of <code>lsm_l_pr</code> this the number of classes
present.</p>
<p><img src="guide_moving_window_files/figure-html/plot-result-1.png" width="700" style="display: block; margin: auto;"><img src="guide_moving_window_files/figure-html/plot-result-2.png" width="700" style="display: block; margin: auto;"></p>
<p>In the future, we also plan to allow class level metrics, however,
patch metrics are not meaningful (McGarigal 2012) and will not be added
in the future.</p>
<div class="section level3">
<h3 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h3>
<ul>
<li>Fletcher, R., Fortin, M.-J. 2018. Spatial Ecology and Conservation
Modeling: Applications with R. Springer International Publishing. 523
pages</li>
<li>Hagen-Zanker, A. 2016. A computational framework for generalized
moving windows and its application to landscape pattern analysis.
International journal of applied earth observation and geoinformation,
44, 205-216.</li>
<li>McGarigal K., SA Cushman, and E Ene. 2023. FRAGSTATS v4: Spatial
Pattern Analysis Program for Categorical Maps. Computer software program
produced by the authors; available at the following web site: <a href="https://www.fragstats.org" class="external-link uri">https://www.fragstats.org</a>
</li>
<li>Šímová, P., &amp; Gdulová, K. 2012. Landscape indices behavior: A
review of scale effects. Applied Geography, 34, 385–394.</li>
</ul>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Maximilian H.K. Hesselbarth, Marco Sciaini, Jakub Nowosad, Sebastian Hanss.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
